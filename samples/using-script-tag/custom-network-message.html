<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Skyflow Elements</title>
    <!-- <script src="https://js.skyflow.com/v2/index.js"></script> -->
         <script src="https://js.skyflow.dev/v2.6.0-dev.8a1d1ee/index.js"></script>

    <style>
      body {
        display: flex;
        flex-direction: column;
      }
      .empty-div {
        height: 100px;
        width: 350px;
      }
    </style>
  </head>
  <body>
    <h3>Collect Elements</h3>
    <!-- COllect Part -->
    <div>
      <div id="collectCardNumber" class="empty-div"></div>
      <div id="collectCvv" class="empty-div"></div>
      <div id="collectExpiryDate" class="empty-div"></div>
      <div id="collectCardholderName" class="empty-div"></div>
      <div>
        <button id="collectPCIData">Collect PCI Data</button>
        <button id="customNetworkMessage">Custom Error Message</button>
      </div>
      <div>
        <pre id="collectResponse"></pre>
      </div>
    </div>

    <!-- Javascript -->
    <script>
      try {
        const skyflow = Skyflow.init({
          vaultID: '<VAULT_ID>',
          vaultURL: '<VAULT_URL>',
          getBearerToken: () => {
            return new Promise((resolve, reject) => {
              const Http = new XMLHttpRequest();
    
              Http.onreadystatechange = () => {
                if (Http.readyState === 4 && Http.status === 200) {
                  const response = JSON.parse(Http.responseText);
                  resolve(response.accessToken);
                }
              };
              const url = '<TOKEN_END_POINT_URL>';
              Http.open('GET', url);
              Http.send();
            });
          },
          options: {
            logLevel: Skyflow.LogLevel.ERROR,
            env: Skyflow.Env.PROD,
          },
        });
    
        // Create collect Container.
        const collectContainer = skyflow.container(Skyflow.ContainerType.COLLECT);
    
        // Custom styles for collect elements.
        const collectStylesOptions = {
          inputStyles: {
            base: {
              border: '1px solid #eae8ee',
              padding: '10px 16px',
              borderRadius: '4px',
              color: '#1d1d1d',
              marginTop: '4px',
              fontFamily: '"Roboto", sans-serif'
            },
            complete: {
              color: '#4caf50',
            },
            empty: {},
            focus: {},
            invalid: {
              color: '#f44336',
            },
            global: {
              '@import' :'url("https://fonts.googleapis.com/css2?family=Roboto&display=swap")',
            }
          },
          labelStyles: {
            base: {
              fontSize: '16px',
              fontWeight: 'bold',
              fontFamily: '"Roboto", sans-serif'
            },
            global: {
              '@import' :'url("https://fonts.googleapis.com/css2?family=Roboto&display=swap")',
            },
            requiredAsterisk:{
              color: 'red'
            }
          },
          errorTextStyles: {
            base: {
              color: '#f44336',
              fontFamily: '"Roboto", sans-serif'
            },
            global: {
              '@import' :'url("https://fonts.googleapis.com/css2?family=Roboto&display=swap")',
            }
          },
        };
    
        // Create collect elements.
        const cardNumberElement = collectContainer.create({
          table: 'pii_fields',
          column: 'primary_card.card_number',
          ...collectStylesOptions,
          placeholder: 'card number',
          label: 'Card Number',
          type: Skyflow.ElementType.CARD_NUMBER,
        },{
          required: true
        });
    
        const cvvElement = collectContainer.create({
          table: 'pii_fields',
          column: 'primary_card.cvv',
          ...collectStylesOptions,
          label: 'Cvv',
          placeholder: 'cvv',
          type: Skyflow.ElementType.CVV,
        });
    
        const expiryDateElement = collectContainer.create({
          table: 'pii_fields',
          column: 'primary_card.expiry_date',
          ...collectStylesOptions,
          label: 'Expiry Date',
          placeholder: 'MM/YYYY',
          type: Skyflow.ElementType.EXPIRATION_DATE,
        });
    
        const cardHolderNameElement = collectContainer.create({
          table: 'pii_fields',
          column: 'first_name',
          ...collectStylesOptions,
          label: 'Card Holder Name',
          placeholder: 'cardholder name',
          type: Skyflow.ElementType.CARDHOLDER_NAME,
        });
    
        // Mount the elements.
        cardNumberElement.mount('#collectCardNumber');
        cvvElement.mount('#collectCvv');
        expiryDateElement.mount('#collectExpiryDate');
        cardHolderNameElement.mount('#collectCardholderName');
    
        // Collect all elements data.
        const collectButton = document.getElementById('collectPCIData');
        if (collectButton) {
          collectButton.addEventListener('click', () => {
            const collectResponse = collectContainer.collect();
            collectResponse
              .then(response => {
                document.getElementById('collectResponse').innerHTML =
                  JSON.stringify(response, null, 2);}).catch(error => console.log(error));
              });
        }
        const customNetworkMessageButton = document.getElementById('customNetworkMessage');
        if (customNetworkMessageButton) {
          customNetworkMessageButton.addEventListener('click', () => {
            collectContainer.setError({
  						[Skyflow.ErrorType.BAD_REQUEST]: "bad request!",
  						[Skyflow.ErrorType.OFFLINE]: "You appear to be offline",
  						[Skyflow.ErrorType.TIMEOUT]: "Too slow",
  						[Skyflow.ErrorType.ABORT]: "Request aborted",
  						[Skyflow.ErrorType.NETWORK_GENERIC]: "Unknown network issue",
			});
          });
        }
        } catch (err) {
        console.log(err);
      }
    </script>
  </body>
</html>
