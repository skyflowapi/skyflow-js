<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Skyflow Elements</title>
    <script src="https://js.skyflow.com/v2/index.js"></script>
    <style>
      body {
        display: flex;
        flex-direction: column;
      }
      .empty-div {
      }
      .reveal-view {
        margin-top: 48px;
      }
    </style>
  </head>
  <body>
    <!-- Reveal Part-->
    <div id="revealView" class="reveal-view">
      <h3>Reveal Elements</h3>
      <div id="revealComposableContainer" class="empty-div"></div>
        <button id="revealPCIData">Reveal PCI Data</button>
      </div>
    </div>
    
    <script>
        try {
  const config = {
    vaultID: '<VAULT_ID>',
    vaultURL: '<VAULT_URL>',
    getBearerToken: () => {
      return new Promise((resolve, reject) => {
        const Http = new XMLHttpRequest();

        Http.onreadystatechange = () => {
          if (Http.readyState === 4 && Http.status === 200) {
            const response = JSON.parse(Http.responseText);
            resolve(response.accessToken);
          }
        };
        const url = '<TOKEN_END_POINT_URL>';
        Http.open('GET', url);
        Http.send();
      });
    },
    options: {
      logLevel: Skyflow.LogLevel.ERROR,
      env: Skyflow.Env.PROD,
    }
  }
  const skyflowClient = Skyflow.init(config);


    const revealStyleOptions = {
            inputStyles: {
              base: {
                border: '1px solid #eae8ee',
                padding: '10px 16px',
                borderRadius: '4px',
                color: '#1d1d1d',
                marginTop: '4px',
                fontFamily: '"Roboto", sans-serif'
              },
              global: {
                '@import' :'url("https://fonts.googleapis.com/css2?family=Roboto&display=swap")',
              }
            },
            labelStyles: {
              base: {
                fontSize: '16px',
                fontWeight: 'bold',
                fontFamily: '"Roboto", sans-serif'
              },
              global: {
                '@import' :'url("https://fonts.googleapis.com/css2?family=Roboto&display=swap")',
              }
            },
            errorTextStyles: {
              base: {
                color: '#f44336',
                fontFamily: '"Roboto", sans-serif'
              },
              global: {
                '@import' :'url("https://fonts.googleapis.com/css2?family=Roboto&display=swap")',
              }
            },
          };
    const revealContainerOptions = {
				layout: [1, 1, 1, 1],
				styles: {
					base: {
						border: '1px solid #eae8ee',
						padding: '30px 16px',
						borderRadius: '4px',
						margin: '12px 2px',
						boxShadow: '8px',
            width: '400px',
					}
				},
				errorTextStyles: {
					base: {
						color: 'red',
						fontFamily: '"Roboto", sans-serif'
					},
					global: {
						'@import' :'url("https://fonts.googleapis.com/css2?family=Roboto&display=swap")',
					}
				}
    }

          const revealContainer = skyflowClient.container(Skyflow.ContainerType.COMPOSE_REVEAL, revealContainerOptions);;


          const revealCardNumberInput = {
            token: "<TOKEN1>",
            label: 'Card Number',
            redaction: Skyflow.RedactionType.MASKED,
            ...revealStyleOptions,
          }
          const revealCardNumberElement = revealContainer.create(revealCardNumberInput);

          const revealCardCvvInput = {
            token: "<TOKEN2>",
            label: 'CVV',
            redaction: Skyflow.RedactionType.REDACTED,
            ...revealStyleOptions,
            altText: '###',
          }
          const revealCardCvvElement = revealContainer.create(revealCardCvvInput);

          const revealCardExpiryInput = {
            token: "<TOKEN3>",
            label: 'Card Expiry Date',
            ...revealStyleOptions,
          }
          const revealCardExpiryElement = revealContainer.create(revealCardExpiryInput);

          const revealCardholderNameInput = {
            token: "<TOKEN4>",
            label: 'Card Holder Name',
            ...revealStyleOptions,
          }
          const revealCardholderNameElement = revealContainer.create(revealCardholderNameInput);

          revealContainer.mount(document.getElementById('revealComposableContainer'));

          const revealButton = document.getElementById('revealPCIData');

          if (revealButton) {
            revealButton.addEventListener('click', () => {
              const revealResponse = revealContainer.reveal()
              revealResponse.then((res) => {
                console.log(res);
              }).catch((err) => {
                console.log(err);
              });
            });
          }
        } catch (err) {
            console.log(err);
        }
    </script>
  </body>
</html>
